CREATE TABLE SAILOR_14
(
    SID VARCHAR2(4) PRIMARY KEY CHECK (SID LIKE 's%'),
    SNAME VARCHAR2(10) CHECK (REGEXP_LIKE(SNAME, '^[A-Z].*')),
    MNAME VARCHAR2(10),
    SURNAME VARCHAR2(10) NOT NULL,
    RATING NUMBER(2) DEFAULT 0,
    AGE NUMBER(3,1) NOT NULL
);

DESC SAILOR_14;

INSERT INTO SAILOR_14 VALUES('s22', 'FREDRICO', NULL, 'ROBERTS', 7, 45);
INSERT INTO SAILOR_14 VALUES('s31', 'LUBBER', NULL, 'SHEEN', 8, 55.5);
INSERT INTO SAILOR_14 VALUES('s32', 'CHARLOTTE', NULL, 'GORDIN', 8, 25.5);
INSERT INTO SAILOR_14 VALUES('s58', 'MARY', 'BETH', 'LYON', 10, 35);
INSERT INTO SAILOR_14 VALUES('s64', 'HORATIO', NULL, 'POWELL', 7, 35.4);
INSERT INTO SAILOR_14 VALUES('s71', 'ZORBA', NULL, 'ALEX', 10, 16);
INSERT INTO SAILOR_14 VALUES('s29', 'BRUTUS', NULL, 'SLATER', 1, 33.8);
INSERT INTO SAILOR_14 VALUES('s95', 'DEEP', 'GRACEB', 'DAVIS', 3, 63.5);
INSERT INTO SAILOR_14 VALUES('s74', 'HORATIO', NULL, 'FORREST', 9, 35);
INSERT INTO SAILOR_14 VALUES('s85', 'SARA', 'ART', 'POWELL', 3, 25.5);
INSERT INTO SAILOR_14 VALUES('s80', 'DEEP', 'KUMAR', 'KUMAR', 6, 17);
INSERT INTO SAILOR_14 VALUES('s87', 'DEEP', 'KUMAR', 'JHA', NULL, 51);
SELECT * FROM SAILOR_14;

CREATE TABLE BOAT_14 
(
    BID NUMBER(3) PRIMARY KEY,
    BNAME VARCHAR2(10) CHECK (BNAME = UPPER(BNAME)),
    COLOR VARCHAR2(6) CHECK (COLOR IN ('red', 'green', 'blue'))
);
DESC BOAT_14;

INSERT INTO BOAT_14 VALUES(101, 'INTERLAKE', 'blue');
INSERT INTO BOAT_14 VALUES(102, 'INTERLAKE', 'red');
INSERT INTO BOAT_14 VALUES(103, 'CLIPPER', 'green');
INSERT INTO BOAT_14 VALUES(104, 'MARINE', 'red');
SELECT * FROM BOAT_14;

CREATE TABLE RESERVTAION_14 
(
    SID VARCHAR2(4), 
    BID NUMBER(3), 
    DAY DATE CHECK (DAY < TO_DATE('01-JAN-2000', 'DD-MON-YYYY')),
    PRIMARY KEY (SID, BID),
    FOREIGN KEY (SID) REFERENCES SAILOR_14(SID),
    FOREIGN KEY (BID) REFERENCES BOAT_14(BID)
);
DESC RESERVTAION_14;

INSERT INTO RESERVTAION_14 VALUES('s22', 101, TO_DATE('10-OCT-98'));
INSERT INTO RESERVTAION_14 VALUES('s22', 103, TO_DATE('10-AUG-98'));
INSERT INTO RESERVTAION_14 VALUES('s22', 102, TO_DATE('10-OCT-98'));
INSERT INTO RESERVTAION_14 VALUES('s22', 104, TO_DATE('10-JUL-98')); 
INSERT INTO RESERVTAION_14 VALUES('s31', 102, TO_DATE('11-OCT-98'));
INSERT INTO RESERVTAION_14 VALUES('s31', 103, TO_DATE('11-JUN-98'));
INSERT INTO RESERVTAION_14 VALUES('s31', 104, TO_DATE('11-DEC-98'));
INSERT INTO RESERVTAION_14 VALUES('s64', 101, TO_DATE('09-MAY-98'));
INSERT INTO RESERVTAION_14 VALUES('s64', 102, TO_DATE('09-AUG-98'));
INSERT INTO RESERVTAION_14 VALUES('s74', 103, TO_DATE('09-AUG-98'));
INSERT INTO RESERVTAION_14 VALUES('s80', 102, TO_DATE('07-JUL-98'));
INSERT INTO RESERVTAION_14 VALUES('s87', 101, TO_DATE('08-JUL-98'));
INSERT INTO RESERVTAION_14 VALUES('s87', 102, TO_DATE('12-DEC-98'));
SELECT * FROM RESERVTAION_14;

1)
SELECT UPPER(SNAME), AGE FROM SAILOR_1419;
2)
SELECT * FROM SAILOR_1419 ORDER BY SNAME ASC;
3)
SELECT DISTINCT SNAME FROM SAILOR_1419;
4)
SELECT DISTINCT SNAME, RATING FROM SAILOR_1419 WHERE RATING BETWEEN 5 AND 10;
5)
SELECT * FROM SAILOR_1419 ORDER BY RATING ASC, AGE DESC;
6)
SELECT * FROM SAILOR_1419 WHERE SNAME = 'Horatio' AND AGE = 35.4;
7)
SELECT DISTINCT SNAME 
FROM SAILOR_1419 
WHERE SID IN (SELECT SID FROM RESERVED_1419 WHERE BID = 104);
8)
SELECT DISTINCT R.SID 
FROM RESERVED_1419 R
JOIN BOAT_1419 B ON R.BID = B.BID
WHERE B.COLOR = 'red';
9)
SELECT DISTINCT SNAME FROM SAILOR_1419 WHERE RATING IS NOT NULL;
10)
SELECT DISTINCT SNAME FROM SAILOR_1419 WHERE RATING IS NULL;
11)
SELECT DISTINCT B.COLOR 
FROM BOAT_1419 B
JOIN RESERVED_1419 R ON B.BID = R.BID
JOIN SAILOR_1419 S ON R.SID = S.SID
WHERE S.SNAME = 'Lubber';
12)
SELECT DISTINCT SNAME 
FROM SAILOR_1419 
WHERE SID IN (SELECT SID FROM RESERVED_1419);
13)
SELECT SNAME 
FROM SAILOR_1419 
WHERE SNAME LIKE 'B%B' AND LENGTH(SNAME) >= 3;
14)
SELECT SNAME 
FROM SAILOR_1419 
WHERE SNAME LIKE 'B%B' AND LENGTH(SNAME) = 3;
15)
SELECT DISTINCT S.SNAME 
FROM SAILOR_1419 S
JOIN RESERVED_1419 R ON S.SID = R.SID
JOIN BOAT_1419 B ON R.BID = B.BID
WHERE B.COLOR IN ('red', 'green');
16)
SELECT DISTINCT S.SNAME 
FROM SAILOR_1419 S
JOIN RESERVED_1419 R ON S.SID = R.SID
JOIN BOAT_1419 B ON R.BID = B.BID
WHERE B.COLOR = 'red' 
AND S.SID NOT IN (
    SELECT DISTINCT R.SID 
    FROM RESERVED_1419 R
    JOIN BOAT_1419 B ON R.BID = B.BID
    WHERE B.COLOR = 'green'
);
17)
SELECT DISTINCT SNAME 
FROM SAILOR_1419 
WHERE SID IN (SELECT SID FROM RESERVED_1419 WHERE BID = 103);
18)
SELECT DISTINCT SNAME 
FROM SAILOR_1419 
WHERE SID IN (
    SELECT R.SID FROM RESERVED_1419 R
    JOIN BOAT_1419 B ON R.BID = B.BID
    WHERE B.COLOR = 'red'
);
19)
SELECT DISTINCT SNAME 
FROM SAILOR_1419 
WHERE SID NOT IN (
    SELECT DISTINCT R.SID FROM RESERVED_1419 R
    JOIN BOAT_1419 B ON R.BID = B.BID
    WHERE B.COLOR = 'red'
);

20. SELECT * FROM SAILOR_14 s1 WHERE s1.RATING > ANY (SELECT s2.RATING FROM SAILOR_14 s2 WHERE s2.SNAME = 'HORATIO');

21. SELECT AVG(AGE) AS AVG_AGE FROM SAILOR_14 WHERE RATING = 10;

22.SELECT SNAME, MNAME, SURNAME FROM SAILOR_14 WHERE AGE > (SELECT MAX(AGE) FROM SAILOR_14 WHERE RATING = 10);

23. SELECT RATING, MIN(AGE) AS YOUNGEST_AGE FROM SAILOR_14 GROUP BY RATING;

24. SELECT RATING, SNAME, MNAME, SURNAME FROM SAILOR_14 WHERE AGE >= 18 ORDER BY RATING;

25. SELECT RATING, AVG(AGE) AS AVG_AGE FROM SAILOR_14 GROUP BY RATING HAVING COUNT(*) >= 2;


26.  SELECT B.BNAME, COUNT(R.SID) AS RESERVATION_COUNT FROM BOAT_14 B JOIN RESERVTAION_14 R ON B.BID = R.BID WHERE B.COLOR = 'red' GROUP BY B.BNAME;


27. SELECT * FROM SAILOR_14 WHERE RATING = (SELECT MAX(RATING) FROM SAILOR_14 WHERE RATING < (SELECT MAX(RATING) FROM SAILOR_14));



28. SELECT SNAME, MNAME, SURNAME FROM SAILOR_14 WHERE RATING = (SELECT RATING FROM (SELECT RATING, ROW_NUMBER() OVER (ORDER BY RATING ASC) AS RN FROM SAILOR_14 GROUP BY RATING) WHERE RN = 3);


29. SELECT S.SID, S.SNAME, S.MNAME, S.SURNAME FROM SAILOR_14 S WHERE NOT EXISTS (
    SELECT B.BID FROM BOAT_14 B WHERE NOT EXISTS (SELECT R.BID FROM RESERVTAION_14 R WHERE R.BID = B.BID AND R.SID = S.SID));


30. SELECT S.SID, S.SNAME, S.MNAME, S.SURNAME, COUNT(R.BID) AS BOAT_COUNT FROM SAILOR_14 S JOIN RESERVTAION_14 R ON S.SID = R.SID GROUP BY S.SID, S.SNAME, S.MNAME, S.SURNAME HAVING COUNT(R.BID) > 2;
